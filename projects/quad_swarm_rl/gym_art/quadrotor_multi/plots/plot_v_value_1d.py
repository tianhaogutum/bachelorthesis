import numpy as np

"""
# How to use:
1. Go to Sample-Factory, actor_critic.py: ActorCriticSeparateWeights: forward function
2. Set a debug point at the first line of the forward function.
    x = self.forward_head(normalized_obs_dict)
3. In PyCharm, go to Console, copy and past code below

tmp_score=[]
idx = []
for i in range(-20, 21): 
    id_i = i * 0.1
    normalized_obs_dict['obs'][0][2]=id_i
    x = self.forward_head(normalized_obs_dict)
    x, new_rnn_states = self.forward_core(x, rnn_states)
    result = self.forward_tail(x, values_only, sample_actions=True)
    tmp_score.append(result['values'].item())
    idx.append(id_i)

print(tmp_score)
print(idx)

4. Copy and paste the print info and replace v_value dict below. 
"""


import plotly.express as px

x = np.array([-2.0, -1.9000000000000001, -1.8, -1.7000000000000002, -1.6, -1.5, -1.4000000000000001, -1.3, -1.2000000000000002, -1.1, -1.0, -0.9, -0.8, -0.7000000000000001, -0.6000000000000001, -0.5, -0.4, -0.30000000000000004, -0.2, -0.1, 0.0, 0.1, 0.2, 0.30000000000000004, 0.4, 0.5, 0.6000000000000001, 0.7000000000000001, 0.8, 0.9, 1.0, 1.1, 1.2000000000000002, 1.3, 1.4000000000000001, 1.5, 1.6, 1.7000000000000002, 1.8, 1.9000000000000001, 2.0]
)
y = np.array([-0.845671534538269, -0.8013916015625, -0.7545280456542969, -0.703644871711731, -0.6482239961624146, -0.5901922583580017, -0.5333994626998901, -0.4778409004211426, -0.40667545795440674, -0.2927020788192749, -0.18562686443328857, -0.1349325180053711, -0.11827457696199417, -0.11708451062440872, -0.12475932389497757, -0.13852012157440186, -0.15591108798980713, -0.1742802858352661, -0.19148015975952148, -0.20642304420471191, -0.21898722648620605, -0.22958791255950928, -0.23880529403686523, -0.2471851110458374, -0.2551685571670532, -0.2630833387374878, -0.2711523771286011, -0.2795056104660034, -0.28818976879119873, -0.29718291759490967, -0.30640923976898193, -0.3157625198364258, -0.3251258134841919, -0.33439791202545166, -0.3435012102127075, -0.35239100456237793, -0.36105310916900635, -0.36949944496154785, -0.3777589797973633, -0.385872483253479, -0.3938831090927124]
)

xmax = x[np.argmax(y)]
ymax = y.max()
text = "max value={:.5f}, x={:.2f}".format(ymax, xmax)

fig = px.scatter(x=x, y=y, title=text)
fig.show()